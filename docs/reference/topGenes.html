<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Rank -Omes by adjusted significance given in a ranked-pathways data frame — topGenes â€¢ pathwayPCA</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">pathwayPCA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/AES-PCA_Walkthrough.html">AES-PCA Walkthrough with pathwayPCA</a>
    </li>
    <li>
      <a href="../articles/Package_Dev_Notes.html">pathwayPCA Package Development Notes</a>
    </li>
    <li>
      <a href="../articles/Supervised_PCA_Walkthrough.html">Supervised PCA Walkthrough with pathwayPCA</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/gabrielodom/pathwayPCA">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Rank -Omes by adjusted significance given in a ranked-pathways data frame</h1>
    </div>

    
    <p>Given a supervised <code>Omics*</code>-class object and a ranked
   pathways data frame returned by either the <code><a href='AESPCA_pVals.html'>AESPCA_pVals</a></code> or
   <code><a href='superPCA_pVals.html'>superPCA_pVals</a></code> functions, calculate the weighted rank the
   genes / proteins / lipids / metabolomes / transcriptomes contained in each
   pathway by the significance of their container pathways.</p>
    

    <pre class="usage"><span class='fu'>topGenes</span>(<span class='no'>object</span>, <span class='no'>pVals_df</span>, <span class='kw'>percentile</span> <span class='kw'>=</span> <span class='fl'>0.01</span>)

<span class='co'># S4 method for OmicsPathway</span>
<span class='fu'>topGenes</span>(<span class='no'>object</span>, <span class='no'>pVals_df</span>, <span class='kw'>percentile</span> <span class='kw'>=</span> <span class='fl'>0.01</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>An object of class <code>OmicsSurv</code>, <code>OmicsReg</code>, or
<code>OmicsCateg</code>.</p></td>
    </tr>
    <tr>
      <th>pVals_df</th>
      <td><p>The ranked pathways data frame returned by either the
<code><a href='AESPCA_pVals.html'>AESPCA_pVals</a></code> or <code><a href='superPCA_pVals.html'>superPCA_pVals</a></code> functions.
Missing \(p\)-values (from trimmed pathways) are omitted.</p></td>
    </tr>
    <tr>
      <th>percentile</th>
      <td><p>Return the most significant \(q\) percent of the features
contained in all pathways. Defaults to 0.01.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of two named numeric vectors. For both vectors, the names are
   the genes, and the values are the scores for those genes. The first vector
   is the sum of scores across all pathways; the second vector is this score
   sum divided by the number of pathways which contain that particular gene.
   The summed vector does not adjust for genes which appear more frequently
   in pathways, while the averaged vector does. See "Details" for more
   information.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function takes in the pathway set information in a valid
   <code>Omics*</code>-class object and a data frame of ranked pathways (as
   returned by either the <code><a href='AESPCA_pVals.html'>AESPCA_pVals</a></code> or
   <code><a href='superPCA_pVals.html'>superPCA_pVals</a></code> functions). This function creates a matrix
   with pathways as the columns and all genes included in those pathways as
   the rows: the \(i, j\) entry of the matrix equals 1 if gene \(i\) is
   an element of pathway \(j\). (This is created after trimming the
   pathways to the assay data frame supplied using the
   <code><a href='expressedOmes.html'>expressedOmes</a></code> function.) The <code>topGenes</code> function then
   multiplies each pathway membership indicator column by the negative
   natural logarithm of the adjusted \(p\)-values for that pathway; if
   multiple FDR adjustment methods are used, then the score is the average of
   each negative logged \(p\)-values. This function then returns two named
   numeric vectors: the sum of these gene scores and the means of the non-
   zero gene scores, sorted in descending order.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
  <span class='co'>###  Load the Example Data  ###</span>
  <span class='fu'>data</span>(<span class='st'>"colonSurv_df"</span>)
  <span class='fu'>data</span>(<span class='st'>"colonGenesets_ls"</span>)

  <span class='co'>###  Create an OmicsSurv Object  ###</span>
  <span class='no'>colon_OmicsSurv</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='create_OmicsPathway.html'>create_OmicsSurv</a></span>(<span class='kw'>assayData_df</span> <span class='kw'>=</span> <span class='no'>colonSurv_df</span>[, -(<span class='fl'>1</span>:<span class='fl'>2</span>)],
                                      <span class='kw'>pathwaySet_ls</span> <span class='kw'>=</span> <span class='no'>colonGenesets_ls</span>,
                                      <span class='kw'>eventTime_vec</span> <span class='kw'>=</span> <span class='no'>colonSurv_df</span>$<span class='no'>OS_time</span>,
                                      <span class='kw'>eventObserved_vec</span> <span class='kw'>=</span> <span class='fu'>as.logical</span>(<span class='no'>colonSurv_df</span>$<span class='no'>OS_event</span>))

  <span class='co'>###  Calculate Pathway p-Values  ###</span>
  <span class='no'>colonSurv_pVals_df</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='superPCA_pVals.html'>superPCA_pVals</a></span>(<span class='kw'>object</span> <span class='kw'>=</span> <span class='no'>colon_OmicsSurv</span>,
                                       <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                                       <span class='kw'>numCores</span> <span class='kw'>=</span> <span class='fl'>2</span>,
                                       <span class='kw'>adjustpValues</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                                       <span class='kw'>adjustment</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Hoch"</span>, <span class='st'>"SidakSD"</span>))

  <span class='co'>###  Find the Top Genes  ###</span>
  <span class='fu'>topGenes</span>(<span class='kw'>object</span> <span class='kw'>=</span> <span class='no'>colon_OmicsSurv</span>, <span class='kw'>pVals_df</span> <span class='kw'>=</span> <span class='no'>colonSurv_pVals_df</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://github.com/gabrielodom'>Gabriel Odom</a>, James Ban, <a href='http://biostat.med.miami.edu/people/primary-faculty/xi-steven-chen-ph.d'>Steven Chen</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
