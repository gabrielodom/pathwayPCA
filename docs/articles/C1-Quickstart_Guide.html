<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 1 - Quickstart Guide • pathwayPCA</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 1 - Quickstart Guide">
<meta property="og:description" content="">
<meta property="og:image" content="https://gabrielodom.github.io/pathwayPCA/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pathwayPCA</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    User Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/C1-Quickstart_Guide.html">Chapter 1 - Quickstart Guide</a>
    </li>
    <li>
      <a href="../articles/C2-Importing_Data.html">Chapter 2 - Import and Tidy Data</a>
    </li>
    <li>
      <a href="../articles/C3-Create_Omics_Objects.html">Chapter 3 - Creating Data Objects</a>
    </li>
    <li>
      <a href="../articles/C4-Methods_Walkthrough.html">Chapter 4 - Test Pathway Significance</a>
    </li>
    <li>
      <a href="../articles/Package_Dev_Notes.html">Package Development Notes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Version Logs</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gabrielodom/pathwayPCA">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Chapter 1 - Quickstart Guide</h1>
                        <h4 class="author">Gabriel Odom</h4>
            
            <h4 class="date">2018-04-26</h4>
      
      <small>Source: <a href="https://github.com/gabrielodom/pathwayPCA/blob/master/vignettes/C1-Quickstart_Guide.Rmd"><code>vignettes/C1-Quickstart_Guide.Rmd</code></a></small>
      <div class="hidden name"><code>C1-Quickstart_Guide.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>1. Overview</h1>
<p>This guide will serve as a brief introduction to pathway significance testing with the <code>pathwayPCA</code> package. We will discuss four steps. For detailed discussion of these four steps, see the appropriate vignettes. This vignette is the introduction and overview chapter in the “Pathway Significance Testing with <code>pathwayPCA</code>” workflow.</p>
<ol start="0" style="list-style-type: decimal">
<li>Download Packages</li>
<li>Import Data (<a href="https://gabrielodom.github.io/pathwayPCA/articles/C2-Importing_Data.html"><em>vignette</em></a>)</li>
<li>Create <code>Omics</code> Data Objects (<a href="https://gabrielodom.github.io/pathwayPCA/articles/C3-Create_Omics_Objects.html"><em>vignette</em></a>)</li>
<li>Test Pathway Significance (<a href="https://gabrielodom.github.io/pathwayPCA/articles/C4-Methods_Walkthrough.html"><em>vignette</em></a>)</li>
<li>Inspect Results</li>
</ol>
<p>Before we get started, you need the <code>pathwayPCA</code> package to run your analysis. Because we are currently in the development phase for Bioconductor, you can install this package from GitHub. Also, if you want your analysis to be performed with parallel computing, you will need a package to help you. We recommend the <code>parallel</code> package. We also recommend the <code>tidyverse</code> package to help you run some of the examples in these vignettes (while the <code>tidyverse</code> package suite is required for many of the examples in the vignettes, it is not required for any of the functions in this package).</p>
<pre><code><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">devtools::install_github("gabrielodom/pathwayPCA")</a></code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pathwayPCA)
<span class="kw">library</span>(tidyverse)
<span class="co">#&gt; -- Attaching packages ----------------------------------------------------------------------------------------------------- tidyverse 1.2.1 --</span>
<span class="co">#&gt; v ggplot2 2.2.1     v purrr   0.2.4</span>
<span class="co">#&gt; v tibble  1.4.2     v dplyr   0.7.4</span>
<span class="co">#&gt; v tidyr   0.8.0     v stringr 1.3.0</span>
<span class="co">#&gt; v readr   1.1.1     v forcats 0.3.0</span>
<span class="co">#&gt; -- Conflicts -------------------------------------------------------------------------------------------------------- tidyverse_conflicts() --</span>
<span class="co">#&gt; x dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; x dplyr::lag()    masks stats::lag()</span>
<span class="kw">library</span>(parallel)</code></pre></div>
<hr>
<p></p>
</div>
<div id="import-data" class="section level1">
<h1 class="hasAnchor">
<a href="#import-data" class="anchor"></a>2. Import Data</h1>
<p>This section is a quick overview of the material covered in the <a href="https://gabrielodom.github.io/pathwayPCA/articles/C2-Importing_Data.html">Import and Tidy Data</a> vignette. We will cover three data import steps.</p>
<div id="import--gmt-files" class="section level2">
<h2 class="hasAnchor">
<a href="#import--gmt-files" class="anchor"></a>2.1 Import <code>.gmt</code> Files</h2>
<p>The <code>.gmt</code> format is a commonly used file format for storing <a href="https://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/Data_formats#GMT:_Gene_Matrix_Transposed_file_format_.28.2A.gmt.29">pathway set information</a>. Gene sets in the Molecular Signatures Database (MSigDB) can be downloaded from the MSigDB Collections page. Use the <code>read_gmt</code> function to import a <code>.gmt</code> file into R. All <code>.gmt</code> files have a “description” field, but it can be empty. We use <code>description = FALSE</code> argument to skip importing that field.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gmt_path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"c2.cp.v6.0.symbols.gmt"</span>,
                         <span class="dt">package =</span> <span class="st">"pathwayPCA"</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)
gene_set_ls &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_gmt.html">read_gmt</a></span>(gmt_path, <span class="dt">description =</span> <span class="ot">FALSE</span>)
gene_set_ls</code></pre></div>
<pre><code>#&gt; Object with Class(es) 'pathwaySet', 'list' [package 'pathwayPCA'] with 2 elements: 
#&gt;  $ pathways:List of 1329
#&gt;  $ TERMS   : chr [1:1329] "KEGG_GLYCOLYSIS_GLUCONEOGENESIS" ...</code></pre>
<p>The imported <code>.gmt</code> file is stored as a <code>pathwaySet</code> list object. This list contains:</p>
<ul>
<li>a list of the gene names contained in each pathway set (<code>pathways</code>),</li>
<li>the names of the pathways (<code>TERMS</code>), and</li>
<li>(<em>OPTIONAL</em>) the hyperlink to the pathway description card on the GSEA website (<code>description</code>) if you specify <code>description = TRUE</code>.</li>
</ul>
<p>Specifically, the <code>description</code> field contains any notes or details on the pathway that is stored in the second entry of each row of the <code>.gmt</code> file. This field is often left empty.</p>
</div>
<div id="import-and-tidy-assay-data" class="section level2">
<h2 class="hasAnchor">
<a href="#import-and-tidy-assay-data" class="anchor"></a>2.2 Import and Tidy Assay Data</h2>
<p>We assume that the assay data (e.g. transcriptomic data) is either in an Excel file or flat text file. For example, your data may look like this:</p>
<div class="figure">
<img src="example_assay_data.PNG">
</div>
<p>In this data set, the columns are individual samples. The values in each row are the -Omic expression measurements for that gene. Use the <code>read_csv</code> function from the <code>readr</code> package to import <code>.csv</code> files into <code>R</code> as <a href="https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html">tibble</a> (table <em>and</em> data frame) objects. The <code>read_csv</code> function prints messages to the screen informing you of the assumptions it makes when importing your data. Specifically, this message tells us that all the imported data is numeric (<code>col_double()</code>) except for the gene name column (<code>X1 = col_character()</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">assay_path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"ex_assay_subset.csv"</span>,
                          <span class="dt">package =</span> <span class="st">"pathwayPCA"</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)
assay_df &lt;-<span class="st"> </span><span class="kw">read_csv</span>(assay_path)</code></pre></div>
<pre><code>#&gt; Warning: Missing column names filled in: 'X1' [1]
#&gt; Parsed with column specification:
#&gt; cols(
#&gt;   .default = col_double(),
#&gt;   X1 = col_character()
#&gt; )
#&gt; See spec(...) for full column specifications.</code></pre>
<p>Incidentally, we consider gene names to adhere to the following conditions:</p>
<ul>
<li>gene names must start with an English letter (a-z or A-Z), and</li>
<li>gene names can only contain English letters, Arabic numerals (0-9), and possibly a dash (-).</li>
</ul>
<p>Furthermore, if your data has samples in the columns and -omic feature measurements in the rows (like the data set above), you’ll need to “tidy” the imported assay with the <code>transpose_assay</code> function. Now see that the rows from our Excel file are the columns in the tidy data before performing data analysis.</p>
<pre><code>#&gt; # A tibble: 36 x 18
#&gt;    Sample    SOAT1   LSS  SQLE   EBP CYP51A1 DHCR7 CYP27B1 DHCR24 HSD17B7
#&gt;    &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
#&gt;  1 T21101311  5.37  9.77  7.74  4.68    8.27  8.32    6.78   4.70    7.63
#&gt;  2 T21101312  5.52  9.78  8.06  5.12    8.21  8.33    6.47   5.06    7.63
#&gt;  3 T21101313  5.89  8.11  7.00  5.78    8.20  8.39    6.57   4.89    8.15
#&gt;  4 T21101314  5.62  8.67  8.59  5.64    8.07  8.64    6.47   4.98    8.13
#&gt;  5 T21101315  5.49  9.83  8.13  5.73    9.38  8.15    6.43   5.03    7.70
#&gt;  6 T21101316  5.58  9.85  8.55  5.13    9.40  8.71    6.56   4.87    7.75
#&gt;  7 T21101317  5.32 10.0   6.99  5.86    8.08  9.25    6.86   4.72    7.88
#&gt;  8 T21101318  5.49  9.72  7.47  5.16    6.67  7.37    6.70   4.92    7.50
#&gt;  9 T21101319  5.57  9.88  7.97  5.40    7.91  8.06    6.58   5.06    8.16
#&gt; 10 T21101320  5.16  9.87  7.42  5.50    7.43  8.68    6.55   4.85    8.20
#&gt; # ... with 26 more rows, and 8 more variables: MSMO1 &lt;dbl&gt;, FDFT1 &lt;dbl&gt;,
#&gt; #   SC5DL &lt;dbl&gt;, LIPA &lt;dbl&gt;, CEL &lt;dbl&gt;, TM7SF2 &lt;dbl&gt;, NSDHL &lt;dbl&gt;,
#&gt; #   SOAT2 &lt;dbl&gt;</code></pre>
</div>
<div id="import-phenotype-info" class="section level2">
<h2 class="hasAnchor">
<a href="#import-phenotype-info" class="anchor"></a>2.3 Import Phenotype Info</h2>
<p>Use the <code>read_csv</code> function to import the phenotype data. Once again, the <code>read_csv</code> function displays a message informing us of the types of data in each column. This data is subject survival information which contains the subject ID (<code>Sample</code>), survival time after disease onset in months (<code>eventTime</code>), and an indicator if the subject died or was lost to follow up (<code>eventObserved</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pInfo_path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"ex_pInfo_subset.csv"</span>,
                          <span class="dt">package =</span> <span class="st">"pathwayPCA"</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)
pInfo_df &lt;-<span class="st"> </span><span class="kw">read_csv</span>(pInfo_path)
pInfo_df</code></pre></div>
<pre><code>#&gt; Parsed with column specification:
#&gt; cols(
#&gt;   Sample = col_character(),
#&gt;   eventTime = col_double(),
#&gt;   eventObserved = col_logical()
#&gt; )
#&gt; # A tibble: 36 x 3
#&gt;    Sample    eventTime eventObserved
#&gt;    &lt;chr&gt;         &lt;dbl&gt; &lt;lgl&gt;        
#&gt;  1 T21101311     14.2  TRUE         
#&gt;  2 T21101312      1.00 TRUE         
#&gt;  3 T21101313      6.75 FALSE        
#&gt;  4 T21101314      8.50 TRUE         
#&gt;  5 T21101315      7.25 FALSE        
#&gt;  6 T21101316      5.00 TRUE         
#&gt;  7 T21101317     20.0  TRUE         
#&gt;  8 T21101318     13.2  FALSE        
#&gt;  9 T21101319      7.75 FALSE        
#&gt; 10 T21101320      9.00 FALSE        
#&gt; # ... with 26 more rows</code></pre>
</div>
<div id="match-the-phenotype-and-assay-data" class="section level2">
<h2 class="hasAnchor">
<a href="#match-the-phenotype-and-assay-data" class="anchor"></a>2.4 Match the Phenotype and Assay Data</h2>
<p>Now that you have the measurement data in tidy form (<code>assayT_df</code>) and the response data (<code>pInfo_df</code>), you can use the <code>inner_join</code> function from the <code>dplyr</code> package to match the assay measurements to phenotype information by subject identifier.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(joinedExperiment_df &lt;-<span class="st"> </span><span class="kw">inner_join</span>(pInfo_df, assayT_df, <span class="dt">by =</span> <span class="st">"Sample"</span>))
<span class="co">#&gt; # A tibble: 36 x 20</span>
<span class="co">#&gt;    Sample    eventTime eventObserved SOAT1   LSS  SQLE   EBP CYP51A1 DHCR7</span>
<span class="co">#&gt;    &lt;chr&gt;         &lt;dbl&gt; &lt;lgl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 T21101311     14.2  TRUE           5.37  9.77  7.74  4.68    8.27  8.32</span>
<span class="co">#&gt;  2 T21101312      1.00 TRUE           5.52  9.78  8.06  5.12    8.21  8.33</span>
<span class="co">#&gt;  3 T21101313      6.75 FALSE          5.89  8.11  7.00  5.78    8.20  8.39</span>
<span class="co">#&gt;  4 T21101314      8.50 TRUE           5.62  8.67  8.59  5.64    8.07  8.64</span>
<span class="co">#&gt;  5 T21101315      7.25 FALSE          5.49  9.83  8.13  5.73    9.38  8.15</span>
<span class="co">#&gt;  6 T21101316      5.00 TRUE           5.58  9.85  8.55  5.13    9.40  8.71</span>
<span class="co">#&gt;  7 T21101317     20.0  TRUE           5.32 10.0   6.99  5.86    8.08  9.25</span>
<span class="co">#&gt;  8 T21101318     13.2  FALSE          5.49  9.72  7.47  5.16    6.67  7.37</span>
<span class="co">#&gt;  9 T21101319      7.75 FALSE          5.57  9.88  7.97  5.40    7.91  8.06</span>
<span class="co">#&gt; 10 T21101320      9.00 FALSE          5.16  9.87  7.42  5.50    7.43  8.68</span>
<span class="co">#&gt; # ... with 26 more rows, and 11 more variables: CYP27B1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   DHCR24 &lt;dbl&gt;, HSD17B7 &lt;dbl&gt;, MSMO1 &lt;dbl&gt;, FDFT1 &lt;dbl&gt;, SC5DL &lt;dbl&gt;,</span>
<span class="co">#&gt; #   LIPA &lt;dbl&gt;, CEL &lt;dbl&gt;, TM7SF2 &lt;dbl&gt;, NSDHL &lt;dbl&gt;, SOAT2 &lt;dbl&gt;</span></code></pre></div>
<hr>
<p></p>
</div>
</div>
<div id="create-an-omics-data-object" class="section level1">
<h1 class="hasAnchor">
<a href="#create-an-omics-data-object" class="anchor"></a>3. Create an <code>Omics</code> Data Object</h1>
<p>This section is a quick overview of the material covered in the <a href="https://gabrielodom.github.io/pathwayPCA/articles/C3-Create_Omics_Objects.html">Creating Data Objects</a> vignette.</p>
<div id="create-an-object" class="section level2">
<h2 class="hasAnchor">
<a href="#create-an-object" class="anchor"></a>3.1 Create an Object</h2>
<p>Using the data you just imported, create a data object specific to survival, regression, or categorical responses. There are three classes of <code>Omics</code> objects to match the three types of response, but only one function to learn: the <code>create_Omics</code> function. Each class contains assay information (in tidy format) and <code>pathwaySet</code> (in list format), but the classes differ in the type of response information they can hold. The classes, and their responses, are</p>
<ol style="list-style-type: decimal">
<li>
<code>OmicsSurv</code>—a data object for survival information, which includes event time (the time of last follow-up with a subject) and event indicator (did the subject die, or was the observation right-censored).</li>
<li>
<code>OmicsReg</code>—a data object for continuous responses (usually a vector of linear regression responses).</li>
<li>
<code>OmicsCateg</code>—a data object for categorical responses, the dependent variable of a generalized linear model. Currently, we only support binary classification (through logistic regression).</li>
</ol>
<p>We will create a survival <code>Omics</code> object to hold our assay, pathway set list, and survival response.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">colon_OmicsSurv &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_Omics.html">create_Omics</a></span>(<span class="dt">assayData_df =</span> colonSurv_df[, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)],
                                <span class="dt">pathwaySet_ls =</span> colon_pathwaySet,
                                <span class="dt">response =</span> colonSurv_df[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],
                                <span class="dt">respType =</span> <span class="st">"surv"</span>)
<span class="co">#&gt; Creating object of class OmicsSurv.</span></code></pre></div>
</div>
<div id="inspect-the-object" class="section level2">
<h2 class="hasAnchor">
<a href="#inspect-the-object" class="anchor"></a>3.2 Inspect the Object</h2>
<p>After you create an <code>Omics</code> object, print the object to the screen to view a summary of the data contained therein.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">colon_OmicsSurv
<span class="co">#&gt; Formal class 'OmicsSurv' [package "pathwayPCA"] with 4 slots</span>
<span class="co">#&gt;   ..@ eventTime    : num [1:250] 64.9 59.8 62.4 54.5 46.3 ...</span>
<span class="co">#&gt;   ..@ eventObserved: logi [1:250] FALSE FALSE FALSE FALSE TRUE FALSE ...</span>
<span class="co">#&gt;   ..@ assayData_df :Classes 'tbl_df', 'tbl' and 'data.frame':    250 obs. of  656 variables:</span>
<span class="co">#&gt;   ..@ pathwaySet   :List of 3</span>
<span class="co">#&gt;   .. ..- attr(*, "class")= chr [1:2] "pathwaySet" "list"</span></code></pre></div>
</div>
<div id="detailed-object-views" class="section level2">
<h2 class="hasAnchor">
<a href="#detailed-object-views" class="anchor"></a>3.3 Detailed Object Views</h2>
<p>Because the printing procedure for <code>Omics</code> objects is to show a summary of the contents, you need to use the <code>get*()</code> functions to view the individual components of the <code>colon_OmicsSurv</code> object we just created. Overall, you can use accessor functions to extract, edit, or replace data contained in the object. The accessor functions are listed in more detail in the <a href="https://gabrielodom.github.io/pathwayPCA/articles/C3-Create_Omics_Objects.html#table-of-accessors">Table of Accessors</a> subsection of Chapter 3. Use these functions to confirm that the data object you created accurately reflects the data you intend to analyze.</p>
<div id="view-the-assay" class="section level3">
<h3 class="hasAnchor">
<a href="#view-the-assay" class="anchor"></a>3.3.1 View the Assay</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/get_set_OmicsPathway.html">getAssay</a></span>(colon_OmicsSurv)
<span class="co">#&gt; # A tibble: 250 x 656</span>
<span class="co">#&gt;      JUN  SOS2  PAK3  RAF1 PRKCB   BTC  SHC1 PRKCA  ELK1  NRG1  PAK2  MTOR</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1  9.29  5.48  8.21  8.03  5.49  6.65  8.26  8.94  7.38  7.50  7.32  6.96</span>
<span class="co">#&gt;  2  9.13  6.35  8.33  7.94  6.26  7.02  8.39  9.61  7.53  7.68  6.80  6.96</span>
<span class="co">#&gt;  3  9.37  5.67  7.82  7.74  6.05  7.52  8.69  8.40  7.25  7.33  7.48  7.15</span>
<span class="co">#&gt;  4 10.6   4.94  8.79  7.64  5.37  6.87  7.81  9.80  7.79  8.38  6.16  6.48</span>
<span class="co">#&gt;  5  8.70  5.60  8.75  8.05  6.07  6.49  8.45  8.21  7.60  6.65  7.04  6.66</span>
<span class="co">#&gt;  6  9.78  5.36  7.56  8.07  5.90  6.39  8.87  8.22  7.35  7.83  7.39  6.90</span>
<span class="co">#&gt;  7  9.22  5.05  8.20  7.80  5.55  6.86  8.28  8.97  7.43  7.20  7.04  6.96</span>
<span class="co">#&gt;  8 10.3   5.33  7.82  7.89  6.27  6.25  8.66  9.71  7.38  7.09  7.22  7.11</span>
<span class="co">#&gt;  9 10.8   5.07  7.63  7.69  5.48  7.57  8.36  9.69  6.66  7.22  6.99  6.89</span>
<span class="co">#&gt; 10  9.52  5.50  7.48  7.53  5.71  7.33  8.54  8.14  6.88  7.31  7.01  6.82</span>
<span class="co">#&gt; # ... with 240 more rows, and 644 more variables: PAK4 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   MAP2K4 &lt;dbl&gt;, EIF4EBP1 &lt;dbl&gt;, BAD &lt;dbl&gt;, PRKCG &lt;dbl&gt;, NRG3 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   MAPK9 &lt;dbl&gt;, ERBB4 &lt;dbl&gt;, MAPK10 &lt;dbl&gt;, PTK2 &lt;dbl&gt;, ERBB2 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   ERBB3 &lt;dbl&gt;, MAP2K2 &lt;dbl&gt;, TGFA &lt;dbl&gt;, BRAF &lt;dbl&gt;, MAP2K1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   MAP2K7 &lt;dbl&gt;, ABL1 &lt;dbl&gt;, NRG2 &lt;dbl&gt;, AKT1 &lt;dbl&gt;, ABL2 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   AKT2 &lt;dbl&gt;, SHC4 &lt;dbl&gt;, RPS6KB1 &lt;dbl&gt;, RPS6KB2 &lt;dbl&gt;, AKT3 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   NRAS &lt;dbl&gt;, GRB2 &lt;dbl&gt;, AREG &lt;dbl&gt;, STAT5B &lt;dbl&gt;, MAPK3 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   STAT5A &lt;dbl&gt;, PAK6 &lt;dbl&gt;, SOS1 &lt;dbl&gt;, MYC &lt;dbl&gt;, MAPK1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   NCK1 &lt;dbl&gt;, PIK3R5 &lt;dbl&gt;, NRG4 &lt;dbl&gt;, HRAS &lt;dbl&gt;, MAPK8 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   EGFR &lt;dbl&gt;, GSK3B &lt;dbl&gt;, CBLB &lt;dbl&gt;, KRAS &lt;dbl&gt;, CBL &lt;dbl&gt;,</span>
<span class="co">#&gt; #   SHC3 &lt;dbl&gt;, CDKN1B &lt;dbl&gt;, CDKN1A &lt;dbl&gt;, EGF &lt;dbl&gt;, EREG &lt;dbl&gt;,</span>
<span class="co">#&gt; #   ARAF &lt;dbl&gt;, NCK2 &lt;dbl&gt;, SRC &lt;dbl&gt;, PIK3R3 &lt;dbl&gt;, CAMK2A &lt;dbl&gt;,</span>
<span class="co">#&gt; #   CAMK2B &lt;dbl&gt;, CAMK2D &lt;dbl&gt;, CAMK2G &lt;dbl&gt;, PAK1 &lt;dbl&gt;, CBLC &lt;dbl&gt;,</span>
<span class="co">#&gt; #   CRK &lt;dbl&gt;, PIK3CA &lt;dbl&gt;, PIK3CB &lt;dbl&gt;, CRKL &lt;dbl&gt;, PIK3CD &lt;dbl&gt;,</span>
<span class="co">#&gt; #   GAB1 &lt;dbl&gt;, PLCG1 &lt;dbl&gt;, PLCG2 &lt;dbl&gt;, SHC2 &lt;dbl&gt;, HBEGF &lt;dbl&gt;,</span>
<span class="co">#&gt; #   PIK3CG &lt;dbl&gt;, PIK3R1 &lt;dbl&gt;, PIK3R2 &lt;dbl&gt;, EPHB2 &lt;dbl&gt;, EPHB4 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   EFNA5 &lt;dbl&gt;, PXN &lt;dbl&gt;, CDC42 &lt;dbl&gt;, EFNB3 &lt;dbl&gt;, RRAS &lt;dbl&gt;,</span>
<span class="co">#&gt; #   GRB7 &lt;dbl&gt;, SYNJ1 &lt;dbl&gt;, EPHB3 &lt;dbl&gt;, EFNB1 &lt;dbl&gt;, DNM1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   MAP4K4 &lt;dbl&gt;, GRIA1 &lt;dbl&gt;, EPHB1 &lt;dbl&gt;, ROCK1 &lt;dbl&gt;, ITSN1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   RAP1A &lt;dbl&gt;, RAC1 &lt;dbl&gt;, RAP1B &lt;dbl&gt;, EFNB2 &lt;dbl&gt;, WASL &lt;dbl&gt;,</span>
<span class="co">#&gt; #   TF &lt;dbl&gt;, KALRN &lt;dbl&gt;, RASA1 &lt;dbl&gt;, CASP9 &lt;dbl&gt;, ...</span></code></pre></div>
</div>
<div id="view-the-pathwayset-list" class="section level3">
<h3 class="hasAnchor">
<a href="#view-the-pathwayset-list" class="anchor"></a>3.3.2 View the <code>pathwaySet</code> List</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/get_set_OmicsPathway.html">getPathwaySet</a></span>(colon_OmicsSurv)
<span class="co">#&gt; Object with Class(es) 'pathwaySet', 'list' [package 'pathwayPCA'] with 3 elements: </span>
<span class="co">#&gt;  $ pathways:List of 15</span>
<span class="co">#&gt;  $ TERMS   : Named chr [1:15] "KEGG_PENTOSE_PHOSPHATE_PATHWAY" ...</span>
<span class="co">#&gt;  $ setsize : Named int [1:15] 27 64 ...</span></code></pre></div>
</div>
<div id="view-the-event-time" class="section level3">
<h3 class="hasAnchor">
<a href="#view-the-event-time" class="anchor"></a>3.3.3 View the Event Time</h3>
<p>We can use the vector subsetting mechanic in R (<code>[]</code>) to view only the first ten event times.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/get_set_OmicsSurv.html">getEventTime</a></span>(colon_OmicsSurv)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]
<span class="co">#&gt;  [1] 64.8657534 59.7698630 62.4000000 54.5095890 46.2904110 55.8575343</span>
<span class="co">#&gt;  [7] 57.9616438 54.0493151  0.4273973 41.4246575</span></code></pre></div>
</div>
<div id="view-the-event-indicator" class="section level3">
<h3 class="hasAnchor">
<a href="#view-the-event-indicator" class="anchor"></a>3.3.4 View the Event Indicator</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/get_set_OmicsSurv.html">getEvent</a></span>(colon_OmicsSurv)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]
<span class="co">#&gt;  [1] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE</span></code></pre></div>
<hr>
<p></p>
</div>
</div>
</div>
<div id="test-pathways-for-significance" class="section level1">
<h1 class="hasAnchor">
<a href="#test-pathways-for-significance" class="anchor"></a>4. Test Pathways for Significance</h1>
<p>After you have confirmed that the <code>create_Omics</code> function created the <code>Omics</code> object you wanted, you can analyze the object with adaptive, elastic-net, sparse (AES) PCA or supervised PCA. This section is a quick overview of the material covered in the “AES-PCA” and “Supervised PCA” sections of the <a href="https://gabrielodom.github.io/pathwayPCA/articles/C4-Methods_Walkthrough.html">Test Pathway Significance</a> vignette. For details of these methods functions, please see their respective sections in Chapter 4.</p>
<p>The function arguments are as follows. Both the <code>AESPCA_pVals</code> and <code>superPCA_pVals</code> functions take in an <code>Omics</code> object as the value to the <code>object</code> argument. AES-PCA uses permutation-based <span class="math inline">\(p\)</span>-values, so the <code>numReps</code> argument controls how many permutations to take. The <code>numPCs</code> argument specifies how many principal components will be extracted from each pathway. The <code>parallel</code> and <code>numCores</code> arguments are used to control if and how the functions make use of parallel computing. Finally, the <code>adjustment</code> argument allows you to specify a family-wise error rate (FWER) or false discovery rate (FDR) adjustment for the pathway <span class="math inline">\(p\)</span>-values. These options are documented in the <code>adjustRaw_pVals</code> function (see the <a href="https://gabrielodom.github.io/pathwayPCA/reference/adjustRaw_pVals.html">help documentation</a> for details).</p>
<div id="aes-pca" class="section level2">
<h2 class="hasAnchor">
<a href="#aes-pca" class="anchor"></a>4.1 AES-PCA</h2>
<p>Perform AES-PCA pathway significance testing on the <code>Omics</code> object with the <code>AESPCA_pVals</code> function. For more details on this function, see the <a href="https://gabrielodom.github.io/pathwayPCA/articles/C4-Methods_Walkthrough.html#aes-pca">AES-PCA</a> section of Chapter 4.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surv_aes_pVals_df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/AESPCA_pVals.html">AESPCA_pVals</a></span>(<span class="dt">object =</span> colon_OmicsSurv,
                                  <span class="dt">numReps =</span> <span class="dv">1000</span>,
                                  <span class="dt">numPCs =</span> <span class="dv">2</span>,
                                  <span class="dt">parallel =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">numCores =</span> <span class="dv">2</span>,
                                  <span class="dt">adjustpValues =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">adjustment =</span> <span class="st">"BH"</span>)
<span class="co">#&gt; Of the 676 unique genes in the input pathway set, 9.0% were not expressed in</span>
<span class="co">#&gt;   the input data and were therefore removed.</span>
<span class="co">#&gt; After trimming unexpressed genes from the 15 supplied pathways, we removed 0</span>
<span class="co">#&gt;   pathway(s) because they contained 3 or fewer genes.</span>
<span class="co">#&gt; Of the 656 measured genes in the input data frame, 93.8% were included in at</span>
<span class="co">#&gt;   least one pathway after trimming.</span>
<span class="co">#&gt;  Part 1: Calculate Pathway AES-PCs</span>
<span class="co">#&gt; Initializing Computing Cluster</span>
<span class="co">#&gt; DONE</span>
<span class="co">#&gt; Extracting Pathway PCs in Parallel</span>
<span class="co">#&gt; DONE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Part 2: Calculate Permuted Pathway p-Values</span>
<span class="co">#&gt; Initializing Computing Cluster</span>
<span class="co">#&gt; DONE</span>
<span class="co">#&gt; Extracting Pathway p-Values in Parallel</span>
<span class="co">#&gt; DONE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Part 3: Adjusting p-Values and Sorting Pathway p-Value Data Frame</span>
<span class="co">#&gt; DONE</span></code></pre></div>
</div>
<div id="supervised-pca" class="section level2">
<h2 class="hasAnchor">
<a href="#supervised-pca" class="anchor"></a>4.2 Supervised PCA</h2>
<p>Perform Supervised PCA pathway significance testing on the <code>Omics</code> object with the <code>superPCA_pVals</code> function. For more details on this function, see the <a href="https://gabrielodom.github.io/pathwayPCA/articles/C4-Methods_Walkthrough.html#supervised-pca">Supervised PCA</a> section of Chapter 4.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surv_spr_pVals_df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/superPCA_pVals.html">superPCA_pVals</a></span>(<span class="dt">object =</span> colon_OmicsSurv,
                                    <span class="dt">numPCs =</span> <span class="dv">2</span>,
                                    <span class="dt">parallel =</span> <span class="ot">TRUE</span>,
                                    <span class="dt">numCores =</span> <span class="dv">2</span>,
                                    <span class="dt">adjustpValues =</span> <span class="ot">TRUE</span>,
                                    <span class="dt">adjustment =</span> <span class="st">"BH"</span>)
<span class="co">#&gt; Of the 676 unique genes in the input pathway set, 9.0% were not expressed in</span>
<span class="co">#&gt;   the input data and were therefore removed.</span>
<span class="co">#&gt; After trimming unexpressed genes from the 15 supplied pathways, we removed 0</span>
<span class="co">#&gt;   pathway(s) because they contained 3 or fewer genes.</span>
<span class="co">#&gt; Of the 656 measured genes in the input data frame, 93.8% were included in at</span>
<span class="co">#&gt;   least one pathway after trimming.</span>
<span class="co">#&gt; Initializing Computing Cluster</span>
<span class="co">#&gt; DONE</span>
<span class="co">#&gt; Calculating Pathway Test Statistics in Parallel</span>
<span class="co">#&gt; DONE</span>
<span class="co">#&gt; Calculating Pathway Critical Values in Parallel</span>
<span class="co">#&gt; DONE</span>
<span class="co">#&gt; Calculating Pathway p-Values</span>
<span class="co">#&gt; Adjusting p-Values and Sorting Pathway p-Value Data Frame</span>
<span class="co">#&gt; DONE</span></code></pre></div>
<hr>
<p></p>
</div>
</div>
<div id="inspect-results" class="section level1">
<h1 class="hasAnchor">
<a href="#inspect-results" class="anchor"></a>5. Inspect Results</h1>
<p>This section is a quick overview of the material covered in the “Analyze the Results” section of the <a href="https://gabrielodom.github.io/pathwayPCA/articles/C4-Methods_Walkthrough.html">Test Pathway Significance</a> vignette.</p>
<div id="analysis-output-table" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-output-table" class="anchor"></a>5.1 Analysis Output Table</h2>
<p>For a quick and easy view of the pathway significance testing results, we can simply print the output data frame. If you are not using the <code>tidyverse</code> package suite, your results will print differently (use the <code>head</code> function to print the top pathways instead).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surv_spr_pVals_df
<span class="co">#&gt; # A tibble: 15 x 6</span>
<span class="co">#&gt;    pathways    setsize trim_size terms                        rawp      BH</span>
<span class="co">#&gt;  * &lt;chr&gt;         &lt;int&gt;     &lt;int&gt; &lt;chr&gt;                       &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1 pathway87        87        86 KEGG_ERBB_SIGNALING_PATH~ 0.00178 0.00894</span>
<span class="co">#&gt;  2 pathway491       40        40 PID_EPHB_FWD_PATHWAY      0.00187 0.00894</span>
<span class="co">#&gt;  3 pathway536       46        44 PID_TNF_PATHWAY           0.00220 0.00894</span>
<span class="co">#&gt;  4 pathway781      198       180 REACTOME_PHOSPHOLIPID_ME~ 0.00238 0.00894</span>
<span class="co">#&gt;  5 pathway176       54        54 KEGG_NON_SMALL_CELL_LUNG~ 0.00354 0.00902</span>
<span class="co">#&gt;  6 pathway390       29        29 BIOCARTA_TNFR1_PATHWAY    0.00361 0.00902</span>
<span class="co">#&gt;  7 pathway1211     108       104 REACTOME_SIGNALING_BY_IN~ 0.00447 0.00957</span>
<span class="co">#&gt;  8 pathway757       87        83 REACTOME_INSULIN_RECEPTO~ 0.00605 0.0106 </span>
<span class="co">#&gt;  9 pathway413       23        23 ST_GA12_PATHWAY           0.00634 0.0106 </span>
<span class="co">#&gt; 10 pathway177       30        26 KEGG_ASTHMA               0.0190  0.0286 </span>
<span class="co">#&gt; 11 pathway3         27        26 KEGG_PENTOSE_PHOSPHATE_P~ 0.0223  0.0304 </span>
<span class="co">#&gt; 12 pathway60        64        45 KEGG_RETINOL_METABOLISM   0.0495  0.0599 </span>
<span class="co">#&gt; 13 pathway187       16        16 BIOCARTA_RELA_PATHWAY     0.0519  0.0599 </span>
<span class="co">#&gt; 14 pathway266       11        11 BIOCARTA_SET_PATHWAY      0.189   0.202  </span>
<span class="co">#&gt; 15 pathway120       89        73 KEGG_ANTIGEN_PROCESSING_~ 0.489   0.489</span></code></pre></div>
</div>
<div id="graph-of-top-pathways" class="section level2">
<h2 class="hasAnchor">
<a href="#graph-of-top-pathways" class="anchor"></a>5.2 Graph of Top Pathways</h2>
<p>To visualize the significance of the pathways based on the selected FDR method, we can use the <code>ggplot2</code> package to create summary graphics of the analysis results.</p>
<div id="tidy-up-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#tidy-up-the-data" class="anchor"></a>5.2.1 Tidy Up the Data</h3>
<p>In order to take advantage of the publication-quality graphics created with the <code>ggplot2</code> package, we first need to tidy the data frames returned by the <code>AESPCA_pVals</code> and <code>superPCA_pVals</code> functions. This code takes in the <span class="math inline">\(p\)</span>-values data frame from the Supervised PCA method and modifies it to be compatible with <code>ggplot</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(reshape2)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'reshape2'</span>
<span class="co">#&gt; The following object is masked from 'package:tidyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     smiths</span>
surv_spr_melt_df &lt;-<span class="st"> </span>surv_spr_pVals_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>pathways, <span class="op">-</span><span class="st"> </span>setsize, <span class="op">-</span>trim_size) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">melt</span>(<span class="dt">id.vars =</span> <span class="st">"terms"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">score =</span> <span class="op">-</span><span class="kw">log</span>(value)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">terms =</span> <span class="kw">str_wrap</span>(terms, <span class="dt">width =</span> <span class="dv">20</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">variable =</span> <span class="kw">factor</span>(variable, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"None"</span>, <span class="st">"FDR"</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as.tibble</span>()

surv_spr_melt_df
<span class="co">#&gt; # A tibble: 30 x 4</span>
<span class="co">#&gt;    terms                                        variable   value score</span>
<span class="co">#&gt;    &lt;chr&gt;                                        &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 KEGG_ERBB_SIGNALING_PATHWAY                  None     0.00178  6.33</span>
<span class="co">#&gt;  2 PID_EPHB_FWD_PATHWAY                         None     0.00187  6.28</span>
<span class="co">#&gt;  3 PID_TNF_PATHWAY                              None     0.00220  6.12</span>
<span class="co">#&gt;  4 REACTOME_PHOSPHOLIPID_METABOLISM             None     0.00238  6.04</span>
<span class="co">#&gt;  5 KEGG_NON_SMALL_CELL_LUNG_CANCER              None     0.00354  5.64</span>
<span class="co">#&gt;  6 BIOCARTA_TNFR1_PATHWAY                       None     0.00361  5.62</span>
<span class="co">#&gt;  7 REACTOME_SIGNALING_BY_INSULIN_RECEPTOR       None     0.00447  5.41</span>
<span class="co">#&gt;  8 REACTOME_INSULIN_RECEPTOR_SIGNALLING_CASCADE None     0.00605  5.11</span>
<span class="co">#&gt;  9 ST_GA12_PATHWAY                              None     0.00634  5.06</span>
<span class="co">#&gt; 10 KEGG_ASTHMA                                  None     0.0190   3.96</span>
<span class="co">#&gt; # ... with 20 more rows</span></code></pre></div>
</div>
<div id="graph-pathway-ranks" class="section level3">
<h3 class="hasAnchor">
<a href="#graph-pathway-ranks" class="anchor"></a>5.2.2 Graph Pathway Ranks</h3>
<p>Now that our output is tidy, we can make a bar chart of the pathway significance. First, we consider the raw <span class="math inline">\(p\)</span>-value</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(surv_spr_melt_df) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(terms, score), <span class="dt">y =</span> score) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>, <span class="dt">position =</span> <span class="st">"dodge"</span>, <span class="kw">aes</span>(<span class="dt">fill =</span> variable)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">guide =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"Supervised PCA Significant Colon Pathways by FDR Adjustment"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Pathways"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">"Negative Log p-Value"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="op">-</span><span class="kw">log</span>(<span class="fl">0.01</span>), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>variable)</code></pre></div>
<p><img src="C1-Quickstart_Guide_files/figure-html/surv_spr_pval_plot-1.png" width="100%" height="60%"></p>
<!-- ## Extract Genes from the Top Pathways -->
<!-- Use the `topGenes` function to "score" the genes contained in the top significant pathways. Given that we have so far only considered collections of genes, rather than the genes themselves, we can inspect which genes show up the most often in the top-ranked pathways. -->
<!-- ```{r topSurvGenes} -->
<!-- topGenes(object = colon_OmicsSurv, pVals_df = surv_spr_pVals_df) -->
<!-- ``` -->
<!-- ggplot(surv_spr_melt_df) + -->
<!--   aes(x = terms, y = score, fill = variable) + -->
<!--   geom_bar(stat = "identity", position = "dodge") + -->
<!--   scale_fill_discrete(name = "FDR Adjustment", -->
<!--                       breaks = c("rawp", "BH"), -->
<!--                       labels = c("None", "Benjamini and Hochberg")) + -->
<!--   ggtitle("Significant Colon Pathways by Supervised PCA") + -->
<!--   xlab("Pathways") + -->
<!--   ylab("Log p-Value") + -->
<!--   geom_hline(yintercept = -log(0.01), size = 2) + -->
<!--   geom_hline(yintercept = -log(0.05)) + -->
<!--   coord_flip() -->
<hr>
<p></p>
</div>
</div>
</div>
<div id="review" class="section level1">
<h1 class="hasAnchor">
<a href="#review" class="anchor"></a>6. Review</h1>
<p>Now that you have an idea of how to use this package, please see each of our vignettes for detailed and thorough commentary and guiding information on each of the three topics discussed herein. The vignettes are:</p>
<ul>
<li><a href="https://gabrielodom.github.io/pathwayPCA/articles/C2-Importing_Data.html">Chapter 2: Import Data</a></li>
<li><a href="https://gabrielodom.github.io/pathwayPCA/articles/C3-Create_Omics_Objects.html">Chapter 3: Create <code>Omics</code> Data Objects</a></li>
<li><a href="https://gabrielodom.github.io/pathwayPCA/articles/C4-Methods_Walkthrough.html">Chapter 4: Test Pathway Significance</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#overview">1. Overview</a></li>
      <li>
<a href="#import-data">2. Import Data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#import--gmt-files">2.1 Import <code>.gmt</code> Files</a></li>
      <li><a href="#import-and-tidy-assay-data">2.2 Import and Tidy Assay Data</a></li>
      <li><a href="#import-phenotype-info">2.3 Import Phenotype Info</a></li>
      <li><a href="#match-the-phenotype-and-assay-data">2.4 Match the Phenotype and Assay Data</a></li>
      </ul>
</li>
      <li>
<a href="#create-an-omics-data-object">3. Create an <code>Omics</code> Data Object</a><ul class="nav nav-pills nav-stacked">
<li><a href="#create-an-object">3.1 Create an Object</a></li>
      <li><a href="#inspect-the-object">3.2 Inspect the Object</a></li>
      <li><a href="#detailed-object-views">3.3 Detailed Object Views</a></li>
      </ul>
</li>
      <li>
<a href="#test-pathways-for-significance">4. Test Pathways for Significance</a><ul class="nav nav-pills nav-stacked">
<li><a href="#aes-pca">4.1 AES-PCA</a></li>
      <li><a href="#supervised-pca">4.2 Supervised PCA</a></li>
      </ul>
</li>
      <li>
<a href="#inspect-results">5. Inspect Results</a><ul class="nav nav-pills nav-stacked">
<li><a href="#analysis-output-table">5.1 Analysis Output Table</a></li>
      <li><a href="#graph-of-top-pathways">5.2 Graph of Top Pathways</a></li>
      </ul>
</li>
      <li><a href="#review">6. Review</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/gabrielodom">Gabriel Odom</a>, James Ban, <a href="http://biostat.med.miami.edu/people/primary-faculty/lily-wang-ph.d">Lily Wang</a>, <a href="http://biostat.med.miami.edu/people/primary-faculty/xi-steven-chen-ph.d">Steven Chen</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
